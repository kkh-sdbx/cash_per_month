<html>

<head>
<title>Hello Google!</title>
</head>
<style>
#pingsPongs{
    background-color : cyan;
} 
#ping{
    background-color : green;
}
</style>

<body>
  
  <div id = "pingsPongs">
        <h1> ping pond area</h1>
        <button id = "ping" color = "green"> LET'S GOOOOO!!!</button>
        <img id = "apiImage"> </img>
        <button id = "getAPI">!! GET API !!</button>

  </div>  
  
  <div>
  <ul id="searchResult">
  
  </ul>
  </div>

</body>

<script type ="module">
  const ping = document.getElementById("ping");
  const getAPI= document.getElementById("getAPI");
  const searchResult= document.getElementById("searchResult");

  const updateSearchResult = (data)=>{
    let toAdd = "";

    for(let i=0;i<11;i++){

      let biz_org = data.response.body.items[i].orderInsttNm;
      let biz_name = data.response.body.items[i].prcrmntReqNm;
      let biz_price = data.response.body.items[i].rprsntUprc;

      toAdd = `${biz_org} ${biz_name} ${biz_price}`;
      let added_li = document.createElement("li");
      added_li.innerHTML = toAdd;
      searchResult.appendChild(added_li);
    }
    
    
  };

  ping.addEventListener("click", async ()=>{
	try{
		const response = await fetch("/justGet");

		if(!response.ok){
			throw new Error("something is wrong!" + response.status);
		}

		const data = await response.json();
		console.log(data);
    updateSearchResult(data);

	}
	catch(error){
		console.error("error: ", error );


	}

  });
  getAPI.addEventListener("click", async ()=>{
	try{
		const response = await fetch("/getAPI");

		if(!response.ok){
			throw new Error("something is wrong!" + response.status);
		}

		const data = await response.json();
		console.log(response);
		console.log(data);
	}
	catch(error){
		console.error("error: ", error );


	}

  });
</script>
</html>
